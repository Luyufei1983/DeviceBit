# 10 Trigger

_**The Trigger of Devicebit**_ is the simple form of IFTTT\(IF THIS THEN THAT\). Different alerts \(E-mail or twitter\) can be triggered according to one value or value combination \(edge trigger is supported\).

This tutorial mainly introduces the procedures to trigger E-mail or Twitter alert and send report periodically.

## Hardware

No hardware is required. Only simulate data-upload by API testing tool provided by DeviceBit platform to test trigger functions and send report periodically.

## **Procedures**

## 1 Register DeviceBit Account

\(www.devicebit.com\) ![](https://leweidoc.oss-cn-hangzhou.aliyuncs.com/lewei50/img/devicebitmanual-xj-20180930-1.jpg)

Pic.1 Sign Up

## 2 Add Sensors

Add _**My Device, Sensors: Humidity and Temperature**_ according to previous tutorials \(Please refer Chapter 1&2 for details. Note: note down the sensor ID, for it will be used in Api calling.\)

### 2.1 Add A Device

After login, go to _**My Devices -&gt; Devices-&gt;Add a Device**_ First, click on _**Devices**_ _**-&gt;**_ _**Add A Device**_, as the picture1 below. After entering the related information, click on _**Save**_.

![](https://leweidoc.oss-cn-hangzhou.aliyuncs.com/lewei50/img/devicebitmanual-xj-20180930-2.jpg) Pic.2 Add A Device

### 2.2 Add Sensors

The next step is to add the humitity & temperature sensor. Go to _**My Devices-&gt; Sensors&Controllers-&gt;Sensor**_, click on _**Add**_.

![](https://leweidoc.oss-cn-hangzhou.aliyuncs.com/lewei50/img/devicebitmanual-xj-20180930-3.jpg) Pic.3 Sensors

Then there will be the _**Add A Sensor**_ page. ![](https://leweidoc.oss-cn-hangzhou.aliyuncs.com/lewei50/img/devicebitmanual-xj-20180930-7.jpg) Pic.4 Add Humidity

As the above picture shows, enter Humidity for ID \(Note down the _**ID**_ for it will be used in Api calling\). Select _**Humidity Monitoring**_ for _**Type**_. Seclet _**%**_ for _**Unit**_. Select _**My Device**_ which is created previously. Enter _**Humidity**_ for _**Name**_. If you want others could view the humidity data, tick _**Yes**_ for _**Public**_ item.

Add the _**Temperature**_ sensor in the same way. Please see the following picture.

![](https://leweidoc.oss-cn-hangzhou.aliyuncs.com/lewei50/img/devicebitmanual-xj-20180930-8.jpg) Pic.5 Add Temperature

After setting up, as picture 5 shows, note down the _**ID**_ because it will be used in Api calling.

![](https://leweidoc.oss-cn-hangzhou.aliyuncs.com/lewei50/img/devicebitmanual-xj-20180930-9.jpg) Pic.6 Sensor ID

## 3 Variable Settings

Go to _**IOT applications -&gt;Variables Settings -&gt;Add A Variable**_ \(Please refer to Chapter9 for details.\) to set the variables such as _**hour, date, humidity, temperature**_ etc, and add expressions, as the following picture shows.

![](https://leweidoc.oss-cn-hangzhou.aliyuncs.com/lewei50/img/devicebitmanual-xj-20180930-37.jpg) Pic.9 Variable Settings

First, set different Twitter content, _**Good morning, Good afternoon**_ or _**Good evening**_ according to the system variable _**Hour**_. Click on _**Add Expressions**_, and fill in the information as follows:

![](https://leweidoc.oss-cn-hangzhou.aliyuncs.com/lewei50/img/devicebitmanual-xj-20180930-38.jpg) Pic.10 Hour Settings

Note the _**Type**_ select _**System Variables**_ . The system variables including the _**hour , date**_ and _**time**_. Select _**Hour**_ here._**Decimal Places**_ leave blank, for decimal is not involved here. Tick _**Yes**_ at _**Whether to output text?**_Then, click on _**Test**_, we can see that the current time is 22 o’clock, and the text is _**Good Night**_! \(For the time is at the range 8-12\)

![](https://leweidoc.oss-cn-hangzhou.aliyuncs.com/lewei50/img/devicebitmanual-xj-20180930-39.jpg) Pic.11 Test For Hour

Next, set up _**Date**_ in the same way. Settings for date are very simple. Ignore _**Enable text output**_ for there is no need to set it. The settings and test results are as follows:

![](https://leweidoc.oss-cn-hangzhou.aliyuncs.com/lewei50/img/devicebitmanual-xj-20180930-40.jpg)

Pic.12 Settings &Test For Date

Finally, set the Twitter text according to different measured humidity values. Here, select _**Sigle Sensor**_ for _**Type,**_ select _**My Device**_ and _**Humidity**_ for _**Reference Value**_. Since all the values are integers, the decimal places do not need to be set. If the measured values are decimals, you can set the decimal places here. The format is .0, .00 and so on. The logical relationship between the output text and the value range is as follows, and you can define it by yourself. Then, click on _**Test**_ to check the result.

![](https://leweidoc.oss-cn-hangzhou.aliyuncs.com/lewei50/img/devicebitmanual-xj-20180930-41.jpg)

Pic.13 Settings & Test For Humidity

## 4 Text Settings

Go to _**IOT applications -&gt;Text Edit -&gt;Add Sending Content**_ \(Please refer Chapter9 for details. \) to edit the sending text. Please see the following picture.

Edit text: Click on _**Text Edit -&gt; New text**_ ![](https://leweidoc.oss-cn-hangzhou.aliyuncs.com/lewei50/img/devicebitmanual-xj-20180930-43.jpg)

Pic.14 Text Edit

The settings and test result are as follows. ![](https://leweidoc.oss-cn-hangzhou.aliyuncs.com/lewei50/img/devicebitmanual-xj-20180930-44.jpg)

Pic.15 Settings & Test For Text

The returned content for \[\[ \]\] is the returned value of the system variable in \[\[ \]\], the measured value of the sensor in \[\[ \]\], or the more complex logic operation result of the measured values of the sensor in \[\[ \]\]. For example, the returned content for \[\[date\]\] is the current date. While, the content for the two braces  is the Twitter Text corresponding with the value range of the variable in . For example, in the following picture, the current humidity is 57%. According to the previous logic relationship set for the value range from 41 to 70, the returned text content for  is _**It is comfortable!**_ After setting, you can click on _**Test**_ to see whether the settings are correct. ![](https://leweidoc.oss-cn-hangzhou.aliyuncs.com/lewei50/img/devicebitmanual-xj-20180930-46.jpg) Pic.16 Text List

## 6  Trigger Settings

Next, let's set the trigger. Go to _**IOT applications-&gt;Triggers-&gt;Add A Trigger**_ ![](https://leweidoc.oss-cn-hangzhou.aliyuncs.com/lewei50/img/devicebitmanual-xj-20180930-55.jpg) Pic.19 Trigger Settings

Enter _**Temperature Test**_ for _**Description**_, select _**Temperature**_ for _**Sensor**_, enter _**30**_ in the blank part after _**Greater than**_ for _**Edit Condition**_; untick _**Endge Trigger**_.

Next, _**Enable Text Sending**_: tick _**Yes**_ then, the following page will appear, ![](https://leweidoc.oss-cn-hangzhou.aliyuncs.com/lewei50/img/devicebitmanual-xj-20180930-56.jpg) Pic.20 Text Settings

Let's move on to _**Sending Content**_ _**Sending content**_: select _**Temperature**_ _**Enable Control Unit**_: select Open _**Minimal Trigger Interval**_ : 10 \(default value\) _**Enable**_: tick _**Yes**_. Then, the trigger is on. Please refer to the following picture.

![](https://leweidoc.oss-cn-hangzhou.aliyuncs.com/lewei50/img/devicebitmanual-xj-20180930-57.jpg) Pic.21 Temperature Test

Set up the humidity trigger in the same way. ![](https://leweidoc.oss-cn-hangzhou.aliyuncs.com/lewei50/img/devicebitmanual-xj-20180930-58.jpg) Pic.22 Humidity Test

![](https://leweidoc.oss-cn-hangzhou.aliyuncs.com/lewei50/img/devicebitmanual-xj-20180930-59.jpg)

Pic.23 Trigger List

Thus, the triggers of temperature and humidity are set up, as the above picture shows .

## 7 API Test

The simplest way to test the triggers is to simulate data-upload by using API testing tool.\*\*

At the home page \(the website is www.devicebit.com\) click on _**Documentation**_ ![](https://leweidoc.oss-cn-hangzhou.aliyuncs.com/lewei50/img/devicebitmanual-xj-20180930-1.jpg) Pic.24 Home Page

and then go to _**API Directory-&gt; Sensor -&gt;Upload Sensor Data**_

![](https://leweidoc.oss-cn-hangzhou.aliyuncs.com/lewei50/img/devicebitmanual-xj-20180930-10.jpg) Pic.25 API Directory

Website [http://www.DeviceBit.com/dev/apiList?version=1&sk=69](http://www.DeviceBit.com/dev/apiList?version=1&sk=69)

[http://www.DeviceBit.com/dev/apitest/3](http://www.DeviceBit.com/dev/apitest/3)

![](https://leweidoc.oss-cn-hangzhou.aliyuncs.com/lewei50/img/devicebitmanual-xj-20180930-11.jpg) Pic.26 Online test

Click on _**on-line test**_ ![](https://leweidoc.oss-cn-hangzhou.aliyuncs.com/lewei50/img/devicebitmanual-xj-20180930-12.jpg) Pic.27 API Testing Tool Enter your _**Userkey**_ Enter _**Device ID**_ at API URL [http://www.DeviceBit.com/api/V1/gateway/UpdateSensors/{device](http://www.DeviceBit.com/api/V1/gateway/UpdateSensors/{device) ID} [（01 for exampe）](http://www.lewei50.com/api/V1/gateway/UpdateSensors/你的网关号)

[After entering the device ID, the APIURL is:](http://www.lewei50.com/api/V1/gateway/UpdateSensors/你的网关号) [http://www.DeviceBit.com/api/V1/gateway/UpdateSensors/01](http://www.DeviceBit.com/api/V1/gateway/UpdateSensors/01)

![](https://leweidoc.oss-cn-hangzhou.aliyuncs.com/lewei50/img/devicebitmanual-xj-20180930-13.jpg) Pic.28 Userkey&Device ID

Change _**T1**_ to _**Temperature**_ for _**Name**_; change _**1**_ to _**32**_ for _**Value**_;

Change _**01H1**_ to _**Humidity**_ for _**Name**_; change _**96.2**_ to _**75**_ for _**Value**_.

![](https://leweidoc.oss-cn-hangzhou.aliyuncs.com/lewei50/img/devicebitmanual-xj-20180930-14.jpg)

Click on _**Run**_, and then the result will be displayed . ![](http://upload-images.jianshu.io/upload_images/5875248-9a90e212c9323d95.jpg?imageMogr2/auto-orient/strip|imageView2/2/w/1240) ![](https://leweidoc.oss-cn-hangzhou.aliyuncs.com/lewei50/img/devicebitmanual-xj-20180930-15.jpg) Pic.30 Request Detail

At last, Go to _**My IOT -&gt; Sensors&Controllers-&gt;Sensor List**_, you will see the following value. ![](https://leweidoc.oss-cn-hangzhou.aliyuncs.com/lewei50/img/devicebitmanual-xj-20180930-16.jpg) Pic.31 The Value

You have already received Email, and the LED is on!

